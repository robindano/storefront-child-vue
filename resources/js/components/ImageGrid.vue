<template>
  <div class="image-grid" v-if="$root.images.length">
    <div
      class="image-grid-thumb"
      v-for="image in $root.images"
      :key="image.id"
      @click="$root.currentImage = image"
      :class="{'active': image === $root.currentImage}"
    >
      <img :src="image.thumbnail.url" />
      <div class="remove-thumb" @click="removeImage(image.id)"></div>
    </div>
    <div class="image-grid-thumb upload" @click="$root.showUploader = true">
      <svg xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="0 0 150 150">
        <g>
          <path
            d="M85 50.802H65l-6 6v21a1 1 0 001 1h30a1 1 0 001-1v-21l-6-6zm-6 18v6h-8v-6h-6l10-8 10 8h-6zm-15.172-14l2-2h18.343l2 2H63.828zM85.025 95.104H83.9v-9.84h1.5l1.89 5.25q.18.51.353 1.027.172.518.352 1.028h.06q.18-.51.338-1.028.157-.517.337-1.027l1.86-5.25h1.515v9.84h-1.17v-5.415q0-.66.06-1.455t.105-1.455h-.06l-.78 2.235-1.86 5.1h-.825l-1.86-5.1-.78-2.235h-.06l.098 1.455q.052.795.052 1.455v5.415zm12.495.18q-.675 0-1.282-.255-.608-.255-1.073-.743-.465-.487-.742-1.2-.278-.712-.278-1.612 0-.915.278-1.628.277-.712.742-1.207.465-.495 1.073-.75.607-.255 1.282-.255t1.283.255q.607.255 1.072.75.465.495.742 1.207.278.713.278 1.628 0 .9-.278 1.612-.277.713-.742 1.2-.465.488-1.072.743-.608.255-1.283.255zm0-1.02q.465 0 .855-.203.39-.202.668-.57.277-.367.427-.877.15-.51.15-1.14 0-.63-.15-1.148-.15-.517-.427-.892-.278-.375-.668-.578-.39-.202-.855-.202-.465 0-.855.202-.39.203-.667.578-.278.375-.428.892-.15.518-.15 1.148 0 .63.15 1.14.15.51.428.877.277.368.667.57.39.203.855.203zm6.525.84h-1.23v-7.29h1.02l.105 1.32h.045q.375-.69.908-1.095.532-.405 1.162-.405.435 0 .78.15l-.24 1.08q-.18-.06-.33-.09-.15-.03-.375-.03-.465 0-.967.375-.503.375-.878 1.305v4.68zm6.78.18q-.735 0-1.373-.263-.637-.262-1.11-.75-.472-.487-.742-1.192t-.27-1.605q0-.9.277-1.613.278-.712.735-1.207.458-.495 1.043-.758.585-.262 1.215-.262.69 0 1.237.24.548.24.915.69.368.45.563 1.08.195.63.195 1.41 0 .195-.008.382-.007.188-.037.323h-4.92q.075 1.17.727 1.852.653.683 1.703.683.525 0 .967-.158.443-.157.848-.412l.435.81q-.48.3-1.065.525-.585.225-1.335.225zm-2.295-4.41h3.9q0-1.11-.473-1.688-.472-.577-1.327-.577-.39 0-.743.15-.352.15-.637.442-.285.293-.473.713-.187.42-.247.96zm-69.765 4.41q-.75 0-1.402-.218-.653-.217-1.125-.72-.473-.502-.743-1.312t-.27-1.995v-5.775h1.245v5.805q0 .885.18 1.485.18.6.488.96.307.36.727.517.42.158.9.158.495 0 .915-.158.42-.157.735-.517t.495-.96q.18-.6.18-1.485v-5.805h1.2v5.775q0 1.185-.27 1.995t-.742 1.312q-.473.503-1.118.72-.645.218-1.395.218zm7.29 2.895h-1.23V87.814h1.02l.105.84h.045q.495-.42 1.087-.72.593-.3 1.238-.3.705 0 1.245.262.54.263.9.75.36.488.548 1.17.187.683.187 1.538 0 .93-.255 1.657-.255.728-.69 1.238-.435.51-1.005.772-.57.263-1.2.263-.51 0-1.012-.225-.503-.225-1.013-.615l.03 1.275v2.46zm1.785-3.93q.45 0 .833-.203.382-.202.659-.57.278-.367.436-.907.157-.54.157-1.215 0-.6-.105-1.095t-.337-.848q-.233-.352-.6-.547-.368-.195-.878-.195-.465 0-.937.255-.473.255-1.013.735v3.825q.495.42.96.592.465.173.825.173zm6.615 1.035q-.705 0-1.005-.42-.3-.42-.3-1.23v-9.21h1.23v9.3q0 .3.105.42t.24.12h.113q.052 0 .157-.03l.165.93q-.12.06-.285.09-.165.03-.42.03zm5.355 0q-.675 0-1.282-.255-.608-.255-1.073-.743-.465-.487-.742-1.2-.278-.712-.278-1.612 0-.915.278-1.628.277-.712.742-1.207.465-.495 1.073-.75.607-.255 1.282-.255t1.283.255q.607.255 1.072.75.465.495.743 1.207.277.713.277 1.628 0 .9-.277 1.612-.278.713-.743 1.2-.465.488-1.072.743-.608.255-1.283.255zm0-1.02q.465 0 .855-.203.39-.202.667-.57.278-.367.428-.877.15-.51.15-1.14 0-.63-.15-1.148-.15-.517-.428-.892-.277-.375-.667-.578-.39-.202-.855-.202-.465 0-.855.202-.39.203-.667.578-.278.375-.428.892-.15.518-.15 1.148 0 .63.15 1.14.15.51.428.877.277.368.667.57.39.203.855.203zm6.765 1.02q-.915 0-1.523-.54-.607-.54-.607-1.53 0-1.2 1.065-1.838 1.065-.637 3.405-.892 0-.345-.067-.675-.068-.33-.233-.585-.165-.255-.457-.413-.293-.157-.743-.157-.63 0-1.185.24t-.99.54l-.48-.855q.51-.33 1.245-.638.735-.307 1.62-.307 1.335 0 1.935.817.6.818.6 2.183v4.47h-1.02l-.105-.87h-.045q-.525.435-1.125.742-.6.308-1.29.308zm.36-.99q.525 0 .99-.248.465-.247.99-.727v-2.025q-.915.12-1.537.285-.623.165-1.005.39-.383.225-.555.517-.173.293-.173.638 0 .63.375.9t.915.27zm8.01.99q-1.38 0-2.197-.99-.818-.99-.818-2.82 0-.885.263-1.598.262-.712.697-1.207.435-.495 1.005-.765.57-.27 1.2-.27t1.095.225q.465.225.945.615l-.06-1.245v-2.805h1.245v10.68H77.3l-.105-.855h-.045q-.435.42-.997.727-.563.308-1.208.308zm.27-1.035q.51 0 .96-.248.45-.247.9-.757v-3.81q-.465-.42-.892-.593-.428-.172-.878-.172-.435 0-.817.202-.383.203-.668.57-.285.368-.45.878-.165.51-.165 1.14 0 1.32.525 2.055.525.735 1.485.735z"
          />
        </g>
      </svg>
    </div>
  </div>
</template>

<script>
export default {
  methods: {
    removeImage(id) {
      this.$root.images = this.$root.images.filter(image => image.id !== id);

      if (!this.$root.images.length) {
        this.$root.showUploader = true;
      }
    }
  }
};
</script>

<style lang="scss" scoped>
.image-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  grid-template-rows: 1fr;
  grid-gap: 0.5rem;
  margin-top: 2rem;
  padding: 0.5em;
  border: 1px solid #666;
}

.image-grid button {
}

.image-grid-thumb {
  display: grid;
  cursor: pointer;
  transition: 250ms;
  border: none;
  position: relative;
}

.upload {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  font-size: 75%;
  color: #666;
  fill: #666;
  border: 1px solid #666;
  filter: opacity(0.5);
  position: relative;
}
.image-grid-thumb.upload:hover {
  filter: opacity(1);
}

.upload svg {
  width: 100%;
  height: auto;
}

.image-grid-thumb.large {
  min-height: 500px;
}

.image-grid-thumb.large svg {
  width: 50px;
  height: 50px;
}

.image-grid-thumb.large span {
  font-size: 16px;
  margin-top: 4px;
}

.image-grid-thumb img {
  width: 100%;
  object-fit: cover;
  grid-area: 1 / 1 / 2 / 2;
}

.image-grid-thumb:hover img,
.image-grid-thumb.active img {
  filter: opacity(0.5);
}

.image-grid-thumb:hover .remove-thumb {
  display: block;
}

.remove-thumb {
  display: none;
  width: 12px;
  height: 12px;
  background-color: red;
  border-radius: 20px;
  position: absolute;
  right: -4px;
  top: -4px;
  filter: opacity(0.75);
}
.remove-thumb:hover {
  filter: opacity(1);
}
</style>